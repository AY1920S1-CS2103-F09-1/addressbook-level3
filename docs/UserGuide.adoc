= Scheduler - User Guide
:site-section: UserGuide
:toc:
:toc-title: Table of Contents
:toc-placement: preamble
:toclevels: 3
:sectnums:
:imagesDir: images
:stylesDir: stylesheets
:xrefstyle: full
:experimental:
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
endif::[]
:repoURL: https://github.com/se-edu/addressbook-level3

By: `Team AY1920S1-CS2103-F09-1`      Since: `Oct 2019`      Licence: `MIT`

== Introduction
Due to vastly different timetables, scheduling interviews that don't clash for applicants to positions in an NUS
Co-Curricular Activity (CCA) can be difficult. Scheduler is an app that can automate this scheduling of interviews for
secretaries in NUS CCAs. Given templates adapted from exported NUSync CCA sign-up lists, Scheduler generates an optimal
matching of interviewees to time slots. Scheduler also supports manual input. It is optimised for people who **prefer
typing in a Command Line Interface (CLI)** to quickly access the functionalities of an app. +

Click on <<Quick Start, Quick Start>> to get started!

== Quick Start
This guide shows you how to import your interviewee and interviewer schedules into Scheduler to begin managing your interview schedule.
It also shows you basic tips on how to add or delete and edit interviewers/interviewees based on your changing needs.

=== Import your csv file into the application
To begin, let's download some comma-separated value (.csv) files with dummy data and import that data into Scheduler.

Click <<Importing existing availabilities `import`, this link>> to download and import a .csv file of availabilities into Scheduler!

=== Manually add interviewees and interviewers
Forgot to include some data before importing? No problem!

To add an interviewee, use the `add` command. Here we add an interviewee with the following characteristics:

. *Name* - John Doe
. *Phone number* - 91234567
. *Faculty* - School of Computing
. *Year of study* - 2019
. *Department of interest* - Marketing
. *Personal Email* - john_doe@gmail.com
. *Work email* (should be an NUS email) - john_doe@u.nus.edu
. *Preferred time slots* - 17/10/2019, 1pm to 2pm

 add r/interviewee n/John Doe p/91234567 f/School of Computing y/2019 ep/john_doe@gmail.com ew/john_doe@u.nus.edu d/Marketing s/17/10/2019 13:00-14:00

* Note that all fields specified above are *compulsory* when adding an interviewee manually.

Similarly, to add an interviewer with the characteristics:

. *Name* - Bohn Coe
. *Phone number* - 9765421
. *Work email* (should be an NUS email) - bohn_coe@u.nus.edu
. *Department* - Marketing
. *Available time slots* - 17/10/2019, 1pm to 2pm

 add r/interviewer n/Bohn Coe p/97654321 ew/bohn_coe@u.nus.edu d/Marketing s/17/10/2019 13:00-14:00

* Again, the fields specified above are *compulsory when adding an interviewer manually.

=== TIP: Converting an Excel file in .csv format

1) Open Excel and click *File -> Open*.

image::quickstart/1_excel.png[width="500", align="left"]

2) In the dialog box, find the Excel file on your computer and click *Open*.

image::quickstart/2_excel.png[width="500", align="left"]

3) On the Excel toolbar, select *File > Save As*.

image::quickstart/3_excel.png[width="500", align="left"]

4) In the dialog box, type a new name for your file in the *File Name* field.

5) In the "Save as Type" drop-down menu, scroll down to locate and select *CSV (comma delimited)*.

image::quickstart/4_excel.png[width="500", align="left"]

6) Click *Save*.

image::quickstart/5_excel.png[width="500", align="left"]


== User Preferences
Scheduler is initialised with default user preferences.

If you wish to make changes to the user preferences, do the following steps: +

* Step 1: Run scheduler.jar at least once. You should notice new files added to the folder containing the application.
* Step 2: Open preferences.json using any word editor, eg. notepad.
* Step 3: Edit the relevant user preference fields.

The details of each user preference field is explained further in the following sections.

=== Working Hours
Each time slot that an interviewer or interviewee indicates, must be within the `startTime` and `endTime` of the pre-defined
working hours for it to be displayed in the schedules.

*Format:* +
`startTime` and `endTime` are defined as strings. It has to follow the string format "HH:mm".

*Default values:* +
`startTime`: "10:00" +
`endTime`: "21:00"

=== Duration of Time slot
Each time slot that an interviewer or interviewee indicates, must be strictly of this pre-defined duration for it to be
 displayed in the schedules. It is represented by `duration` in the user preference file.

*Format:* +
`duration` is defined as a positive integer representing the number of minutes of each time slot.

*Default values:* +
`duration`: 30

* When adding interviewees or interviewers manually into Scheduler, the `SLOT` input provided must have a duration (in minutes) that matches `duration`.

[[Features]]
== Features

====
*Command Format*

* Words in `UPPER_CASE` are the *parameters* to be supplied by the user.
* Items in square brackets `[]` are optional.
* Items with `...` after them can be used multiple times, including zero times.
* *Parameters* can be in any order. E.g if a command specifies `n/NAME p/PHONE`, passing the input as `p/PHONE n/NAME` is also acceptable.
* Example: `add r/interviewee n/NAME p/PHONE f/FACULTY y/YEAR_OF_STUDY ep/PERSONAL_EMAIL ew/NUS_WORK_EMAIL d/DEPARTMENT... s/SLOT... [t/TAG]...`
** `NAME`, `PHONE`. `FACULTY`, `YEAR_OF_STUDY`, `PERSONAL_EMAIL`, `NUS_WORK_EMAIL`, `DEPARTMENT`, `SLOT` and `TAG` are to be supplied by the user.
*** Valid input: `add r/interviewee n/John Doe p/88888888 f/School of Computing y/2019 ep/john_doe@gmail.com ew/john_doe@u.nus.edu d/Marketing s/17/10/2019 13:00-14:00 t/friends`
*** `t/friends` is optional, and can be omitted from the command.
*** Multiple tags can be supplied as input in place of just `t/friends`: `t/friends t/strong t/likesDogs`

====

=== Viewing help `help`
Shows helpful information on using this software.
Format: `help`

=== Importing existing availabilities `import`
The to-be-imported interviewer availability and interviewee details .csv file needs to follow the format as the templates below.
The templates for the import commands can be found here:

* Interviewer availability: http://bit.ly/interviewerTemplate
* Interviewees details: http://bit.ly/intervieweeDetails

After you have imported the data, you will need to type `clear` to clear the imported data before you can import another interviewer's
availability or interviewees details .csv file.

[NOTE]
* Data in .csv file must follow the settings defined in the user preference file. View <<User Preferences, User Preferences>> if you wish to change the
default settings.
* Data to be imported should only be in english and should strictly follow the format of the templates given above.

==== Importing interviewers’ availability
Imports interviewers’ availability from a comma separated values (CSV) file.

* A "1" in a timeslot represents AVAILABLE and "0" represents UNAVAILABLE.
* The headers should also be in the format `DEPARTMENT - INTERVIEWER'S_NAME`.
* Each timeslot should also be in the format `HH:mm - HH:mm`.

[Note]
The schedule displayed will only show timeslots from 10:00 to 21:00 daily.

Format: `import interviewer fp/PATH_TO_FILE` +
    - PATH_TO_FILE is the absolute path to the file. +
    - E.g C:\\Users\Bob\file.csv

Example:

 import interviewer fp/C:\Users\johndoe\Interviewers.csv

==== Importing interviewees’ availability
Imports interviewees’ availability from a comma separated values (CSV) file.

* Emails: Adding more than 1 personal or work email is allowed. Use whitespaces to separate each email.
* Timeslots: Each timeslot should be in the format `HH:mm - HH:mm`. Use commas to separate the timeslots if there are more than 1.

Format: `import interviewee fp/PATH_TO_FILE` +
    - PATH_TO_FILE is the absolute path to the file. +
    - E.g C:\\Users\Bob\file.csv

Example:

 import interviewer fp/C:\Users\johndoe\Interviewees.csv

// tag::add[]

=== Add interviewees/interviewers manually `add`
Manually add a new entity to the database. The command format differs on the `r/ROLE` prefix supplied:

* If `interviewee` is supplied, refer to <<Adding a new interviewee, Adding a new interviewee>> below.
* If `interviewer` is supplied, refer to <<Adding a new interviewer, Adding a new interviewer>> below.

==== Adding a new interviewee
Manually add a new interviewee to the database.

Format: `add r/interviewee n/NAME p/PHONE f/FACULTY y/YEAR_OF_STUDY ep/PERSONAL_EMAIL ew/NUS_WORK_EMAIL d/DEPARTMENT... s/SLOT... [t/TAG]...`

Example:

 add r/interviewee n/John Doe p/88888888 t/CAP5 t/dogLover f/School of Computing ep/JohnDoe@gmail.com ew/JohnDoe@u.nus.edu y/2018 d/Marketing s/20/09/2019 18:00-18:30


====
Constraints:

* A `TAG` must only be alphanumeric and one word, i.e `t/catLover` is correct while `t/cat lover` is not.

* `s/SLOT` must follow the format: `dd/MM/yyyy HH:mm-HH:mm`, where *dd/MM/yyyy* refers to a *date*, the leftmost *HH:mm* refers to the *start duration*
and the rightmost *HH:mm* refers to the *end duration*.
* The date *dd/MM/yyyy* must strictly be a valid date, i.e 30/02/2019  cannot be supplied as a date.
* The duration of a `s/SLOT` must follow these constraints:
** A duration must be in 24-hour format.
** The range of durations available for input must be within <<Working Hours, Working Hours>>.
** The start duration must be earlier than the end duration, and be in increments of `duration`.
The time elapsed from the start duration to end duration must also follow the number of minutes as specified
by the value of `duration` in <<User Preferences, User Preferences>>. See <<Duration of Time slot, Duration of Time slot>> for more details.

====

==== Adding a new interviewer
Manually add a new interviewer to the database.

Format: `add r/interviewer n/NAME p/PHONE ew/NUS_WORK_EMAIL d/DEPARTMENT  s/SLOT... [t/TAG]...`

Example:

 add r/interviewer n/Mary Jane p/98765432 ew/mary_jane@u.nus.edu d/Marketing s/20/09/2019 18:00-18:30

====
Constraints:

* A `TAG` must only be alphanumeric and one word, i.e `t/catLover` is correct while `t/cat lover` is not.

* `s/SLOT` must follow the format: `dd/MM/yyyy HH:mm-HH:mm`, where *dd/MM/yyyy* refers to a *date*, the leftmost *HH:mm* refers to the *start duration*
and the rightmost *HH:mm* refers to the *end duration*.
* The date *dd/MM/yyyy* must strictly be a valid date, i.e 30/02/2019  cannot be supplied as a date.
* The duration of a `s/SLOT` must follow these constraints:
** A duration must be in 24-hour format.
** The range of durations available for input must be within <<Working Hours, Working Hours>>.
** The start duration must be earlier than the end duration, and be in increments of `duration`.
The time elapsed from the start duration to end duration must also follow the number of minutes as specified
by the value of `duration` in <<User Preferences, User Preferences>>. See <<Duration of Time slot, Duration of Time slot>> for more details.
====

// end::add[]

// tag::edit[]

=== Edit interviewees/interviewers manually `edit`
Manually edit an entity in the database. The command format depends on the `r/ROLE` prefix supplied:

* If `interviewee` is supplied, refer to <<Edit an existing interviewee, Edit an existing interviewee>> below.
* If `interviewer` is supplied, refer to <<Edit an existing interviewer, Edit an existing interviewer>> below.

==== Edit an existing interviewee
Manually edit an existing interviewee in the database.

Format: `edit NAME r/interviewee [p/PHONE] [f/FACULTY] [y/YEAR_OF_STUDY] [ep/PERSONAL_EMAIL] [ew/NUS_WORK_EMAIL]
[d/DEPARTMENT]... [s/SLOT]... [t/TAG]...`

Notes:

* An empty tag prefix `t/` can be supplied to reset the tags of an interviewee.
* If a department prefix `d/` is supplied, at least one valid, non-empty department must be provided.
* If a slot prefix `s/` is supplied, at least one valid, non-empty slot must be provided.

Example:

 edit John Doe r/interviewee p/91234567 f/School of Computing s/05/11/2019 18:00-19:00

====
Constraints:

* The interviewee to be edited must exist in the Scheduler.
* `NAME` must be provided after `edit` and before the first prefix `r/ROLE`.
* At least one optional argument must be supplied, i.e `edit NAME r/interviewee` is not valid input.
* A `TAG` must only be alphanumeric and one word, i.e `t/catLover` is correct while `t/cat lover` is not.

* `s/SLOT` must follow the format: `dd/MM/yyyy HH:mm-HH:mm`, where *dd/MM/yyyy* refers to a *date*, the leftmost *HH:mm* refers to the *start duration*
and the rightmost *HH:mm* refers to the *end duration*.
* The date *dd/MM/yyyy* must strictly be a valid date, i.e 30/02/2019  cannot be supplied as a date.
* The duration of a `s/SLOT` must follow these constraints:
** A duration must be in 24-hour format.
** The range of durations available for input must be within <<Working Hours, Working Hours>>.
** The start duration must be earlier than the end duration, and be in increments of `duration`.
The time elapsed from the start duration to end duration must also follow the number of minutes as specified
by the value of `duration` in <<User Preferences, User Preferences>>. See <<Duration of Time slot, Duration of Time slot>> for more details.
====

==== Edit an existing interviewer
Manually edit an existing interviewer in the database.

Format: `edit NAME r/interviewer [p/PHONE] [t/TAG]... [d/DEPARTMENT] [ew/NUS_WORK_EMAIL] [s/SLOT...]`

Notes:

* An empty tag prefix `t/` can be supplied to reset the tags of an interviewee.
* If a slot prefix `s/` is supplied, at least one valid, non-empty slot must be provided.

Example:

 edit John Doe r/interviewee p/91234567 f/School of Computing s/05/11/2019 18:00-19:00

====
Constraints:

* The interviewer to be edited must exist in the Scheduler.
* `NAME` must be provided after `edit` and before the first prefix `r/ROLE`.
* At least one optional argument must be supplied, i.e `edit NAME r/interviewer` is not valid input.
* A `TAG` must only be alphanumeric and one word, i.e `t/catLover` is correct while `t/cat lover` is not.

* `s/SLOT` must follow the format: `dd/MM/yyyy HH:mm-HH:mm`, where *dd/MM/yyyy* refers to a *date*, the leftmost *HH:mm* refers to the *start duration*
and the rightmost *HH:mm* refers to the *end duration*.
* The date *dd/MM/yyyy* must strictly be a valid date, i.e 30/02/2019  cannot be supplied as a date.
* The duration of a `s/SLOT` must follow these constraints:
** A duration must be in 24-hour format.
** The range of durations available for input must be within <<Working Hours, Working Hours>>.
** The start duration must be earlier than the end duration, and be in increments of `duration`.
The time elapsed from the start duration to end duration must also follow the number of minutes as specified
by the value of `duration` in <<User Preferences, User Preferences>>. See <<Duration of Time slot, Duration of Time slot>> for more details.
====

// end::edit[]

// tag::delete[]

=== Delete interviewees/interviewers manually `delete`
Manually delete an entity from the database.

Format: `delete NAME r/ROLE`

* If `interviewee` is supplied as `ROLE`, refer to <<Delete an existing interviewee, Delete an existing interviewee>>.
* If `interviewer` is supplied as `ROLE`, refer to <<Delete an existing interviewer, Delete an existing interviewer>>.

==== Delete an existing interviewee
Deletes the specified interviewee from the database.

Format: `delete NAME r/interviewee`

Example:

 delete John Doe r/interviewee

====

Constraints:

* The interviewee with `NAME` must exist in the Scheduler.

====

==== Delete an existing interviewer
Deletes the specified interviewer from the database.

Format: `delete NAME r/interviewee`

Example:

 delete Bohn Doe r/interviewer

====

Constraints:

* The interviewer with `NAME` must exist in the Scheduler.

====

// end::delete[]

=== UI Display

==== Viewing Schedules
When the Scheduler starts, interview schedules will be displayed for you. The data will be displayed in a table format,
with each table representing the schedule for each day. In the first column, the date of that interview schedule will be
displayed, the rest of the columns are the departments and the name of their respective person in charge. Subsequent rows
will be be displayed by showing the time slot first, with the person allocated to that time slot. If there are no interviewee
occupying that time slot, it will be displayed as "0".

A sample output of the Schedule UI is shown below:

image::Ui/Schedule.png[width="500", align="left"]

For v1.3, the format of the table is as follows.
For the columns in the table, the first cell on the left will display the date of the schedule. It will be followed by the
different departments of the interviewer. The rows display the time slots of availability of the interviewer. "0" represents
that interviewer is unavailable and "1" represents that the interviewer is available.

image::Ui/InterviewerSchedule.png[width="500", align="left"]

==== Viewing details of interviewees [Coming soon in v1.4]
You can view the list of interviewees and the following information:

1. Name
2. NUS Email
3. Personal Email
4. Mobile Number
5. Faculty/School
6. Academic Year
7. Choice of Department 1
8. Choice of Department 2
9. Preferred Time Slots

The interviewee list can be viewed by typing the following command

Format: `display interviewees`

image::Ui/Interviewee.png[width="500", align="left"]

In this screen, you can edit, add or delete interviewees accordingly by using the other features explained in
this User Guide.

==== Differentiating the importance of timetable slots through colours `[Coming in v2.0]`
As you can see from the timetable above, there are 2 different colours of time slots. This is implemented so you
are able to differentiate which interviews are important by using the colour code as shown in the timetable.
By default, the slots will be green in colour. However, you are able to change the colours based on importance using
the following command.

Format: `change DATE TIME IMPORTANCE`

=== Get interview schedule `get` `[Coming in v2.0]`
Find an interviewer/interviewee and display his/her interview schedule.

Format: `get NAME`

Example:

 get "John Doe"

=== Tag interview slot `tag` `[Coming in v2.0]`
Tags an interview slot with a name.

Format: `tag TAG_NAME`

User will also be able to filter by tags.

Format: `filter tag TAG_NAME`

=== Scheduling `schedule`
==== Schedule the interviews
Schedule and allocate interviewees to the available interview slots based on the availability of interviewees and
their choice of department. As of V1.3, the scheduling result is reflected on the console of the application. This will
be updated such that the result is reflected in the displayed interview timetable at v1.4.

Format: `schedule`

=== Exporting of interview schedule `export`
Exports the allocated interview schedule timetable to the indicated comma separated values (CSV) file.

Format: `export fp/FILE_PATH`

* PATH_TO_FILE is the absolute path to the file.
* E.g C:\\Users\Bob\file.csv

Example:

 export fp/C:\Users\johndoe\schedules.csv

Notes:

* This command requires the interview schedule to be generated first!
* If `FILE_PATH` is a valid .csv file but does not exist, it will be created.

=== Sending of email `email`
==== Sending of interview time slot to interviewee
Opens an email dialog containing the interviewee’s allocated interview time slot to a particular interviewee specified, including other details such as the interviewer and location.

Format: `email ct/timeslot n/INTERVIEWEE NAME`

Notes:

* The email dialog will only appear if the interviewee’s email is present in the database and that the interview schedule has already been generated.

==== Sending of interview time slot to all interviewees
Opens an email dialog containing the interviewee's allocated interview time slot to every interviewee, including other details such as the interviewer and location. A summary report is then generated at the end of the command execution.

Format: `email ct/alltimeslot`

Notes:

* The email dialog will only appear if the interviewee’s email is present in the database and that the interview schedule has already been generated.

==== Checking status of emails sent
Provides a summary report of the number of interviewees with emails sent and the total number of interviewees stored in the database.

Format: `email ct/status`

==== Sending of interview results to an interviewee `[Coming in v2.0]`
Opens an email dialog containing the interviewee’s result/interview outcome and other details that you might want to include.

Format: `email ct/results n/INTERVIEWEE NAME`

Note:

* The email dialog will only appear if the interviewee's email is present in the database and the interview results has been updated.

==== Sending of interview results to all interviewees `[Coming in v2.0]`
Opens an email dialog containing the interviewee's result/interview outcome and other details that you might want to include for all interviewees.

Format: `email ct/allresults`

Note:

* The email dialog will only appear if the interviewee's email is present in the database and the interview results has been updated.

=== Recording of additional statuses: `record` `[Coming in v2.0]`
==== Recording of interviewee’s attendance
Bring up the window to record the attendance of interviewees. You can navigate through the table in the window (GUI)
using the directions key to record the attendance of the interviewees. Hit Enter at the target cell to record the
attendance.

Format: `record attendance`

====  Recording of interview result
Bring up the window to record the interview result. The way to record the result is the same as 2.12.1.

Format: `record result`

==== Ranking of interviewees
Bring up the window to rank the interviewees. The way to record the result is the same as 2.12.1.

Format: `record rank`

== FAQ

*Q:* Where can I download the application? +
*A:* Check out the assets in our project release page https://github.com/AY1920S1-CS2103-F09-1/main/releases to download our latest releases!

== Command Summary
.Table Command Summary
|===
|Command Description |Command Syntax

|Help
|`help` +

|Import existing availabilities
|`import interviewer PATH_TO_FILE` +
  `import interviewee PATH_TO_FILE`

|Clear imported data
|`clear` +

|Add interviewee
|`add r/interviewee n/NAME p/PHONE f/FACULTY y/YEAR_OF_STUDY ep/PERSONAL_EMAIL ew/NUS_WORK_EMAIL
d/DEPARTMENT... s/SLOT... [t/TAG]...` +

|Add interviewer
|`add r/interviewer n/NAME p/PHONE ew/NUS_WORK_EMAIL d/DEPARTMENT  s/SLOT... [t/TAG]...` +

|Edit interviewee
|`edit NAME r/interviewee [p/PHONE] [f/FACULTY] [y/YEAR_OF_STUDY] [ep/PERSONAL_EMAIL] [ew/NUS_WORK_EMAIL]
[d/DEPARTMENT]... [s/SLOT]... [t/TAG]...` +

|Edit interviewer
|`edit NAME r/interviewer [p/PHONE] [t/TAG]... [d/DEPARTMENT] [ew/NUS_WORK_EMAIL] [s/SLOT...]` +

|Delete interviewee
|`delete NAME r/interviewee` +

|Delete interviewer
|`delete NAME r/interviewer` +

|Filter
|`filter tag TAG_NAME` +

|Schedule
|`schedule` +

|Export
|`export` +

|Email interviewee
|`email ct/timeslot n/INTERVIEWEE NAME` +
 `email ct/alltimeslot` +
 `email ct/status` +

|Record
|`record attendance` +
 `record result` +
 `record rank` +

|===
